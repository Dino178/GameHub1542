<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ultimate Game Hub — All Games</title>
<style>
:root{
  --bg:#0b0c0e; --panel:#111214; --muted:#9aa0a6; --accent:#ffd166;
  --card:#141518; --ok:#2ecc71; --bad:#e74c3c;
}
body{margin:0;font-family:Inter,system-ui,Segoe UI,Arial,sans-serif;background:var(--bg);color:#e7eef6}
header{background:var(--panel);padding:18px 24px;text-align:center}
header h1{margin:0;color:var(--accent)}
main{max-width:1100px;margin:18px auto;padding:18px}
.menu, .panel{background:var(--card);padding:16px;border-radius:10px;margin-bottom:14px}
button{background:#1f2226;color:#fff;border:0;padding:8px 12px;border-radius:8px;margin:6px;cursor:pointer}
select,input,textarea{padding:8px;border-radius:8px;border:1px solid #222;background:#0e0f11;color:#fff}
label{color:var(--muted);margin-right:10px}
.controls{margin:8px 0}
.small{font-size:13px;color:var(--muted)}
.leaderboard{background:#0e1012;padding:10px;border-radius:8px;margin-top:12px;max-height:260px;overflow:auto;text-align:left}
.resultline{margin-top:8px;color:var(--muted)}
.achievement{color:var(--accent);font-weight:700;margin-top:6px;display:block}
#reactionArea{width:340px;height:140px;margin:14px auto;border-radius:10px;display:flex;align-items:center;justify-content:center;user-select:none;cursor:pointer;background:#1f2226}
.color-btn{width:64px;height:64px;border-radius:8px;display:inline-block;margin:6px;border:3px solid rgba(255,255,255,0.06);cursor:pointer}
.hidden{display:none}
.inline{display:inline-block}
.game-title{margin:0 0 8px 0}
ol{margin:8px 0 0 18px;padding:0}
</style>
</head>
<body>
<header><h1>Ultimate Game Hub</h1></header>
<main>
<section class="menu" id="mainMenu">
  <h2 class="game-title">Games</h2>
  <div class="controls">
    <button onclick="enterGame('guess')">Guess the Number</button>
    <button onclick="enterGame('math')">Math Quiz</button>
    <button onclick="enterGame('reaction')">Reaction Game</button>
    <button onclick="enterGame('typing')">Gibberish Typing</button>
    <button onclick="enterGame('numMemory')">Number Memory</button>
    <button onclick="enterGame('seqTap')">Sequence Tap</button>
    <button onclick="enterGame('wordChain')">Word Memory Chain</button>
  </div>
  <div class="small">Leaderboards persist in your browser (localStorage). Username is asked after selecting a game and cleared when you return to menu.</div>
</section>

<!-- Game panels -->
<div id="panel-guess" class="panel hidden"></div>
<div id="panel-math" class="panel hidden"></div>
<div id="panel-reaction" class="panel hidden"></div>
<div id="panel-typing" class="panel hidden"></div>
<div id="panel-numMemory" class="panel hidden"></div>
<div id="panel-seqTap" class="panel hidden"></div>
<div id="panel-wordChain" class="panel hidden"></div>
</main>

<script>
/* --------------------------- Helper Functions --------------------------- */
function now(){ return performance.now(); }
function lbKey(game,mode){ return 'LH_'+game+'_'+mode; }
function saveToLB(game,mode,entry,comparator){
  const key = lbKey(game,mode);
  let arr = JSON.parse(localStorage.getItem(key)||'[]');
  arr.push(entry); arr.sort(comparator); arr = arr.slice(0,100);
  localStorage.setItem(key,JSON.stringify(arr));
}
function showLBIn(containerId,game,mode,fmt){
  const key = lbKey(game,mode);
  let arr = JSON.parse(localStorage.getItem(key)||'[]');
  const container = document.getElementById(containerId);
  if(!arr.length){ container.innerHTML = '<i>No scores yet for this mode.</i>'; return; }
  let html = '<b>Top '+Math.min(arr.length,100)+'</b><ol>';
  arr.forEach(e=>{ html+='<li>'+escapeHTML(e.name)+' — '+fmt(e)+'</li>'; });
  html+='</ol>';
  container.innerHTML = html;
}
function escapeHTML(s){ return String(s).replace(/[&<>"]/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;'}[c])); }

/* --------------------------- Navigation --------------------------- */
function hideAllPanels(){ document.querySelectorAll('.panel').forEach(p=>p.classList.add('hidden')); }
function returnToMenu(){
  window.__playerName='';
  hideAllPanels();
  document.getElementById('mainMenu').style.display='block';
  document.querySelectorAll('[id$="Play"], [id$="PlayArea"]').forEach(n=>{ if(n) n.innerHTML=''; });
}

/* --------------------------- Enter Game --------------------------- */
function enterGame(key){
  hideAllPanels(); document.getElementById('mainMenu').style.display='none';
  const panel = document.getElementById('panel-'+key); if(!panel) return;
  panel.classList.remove('hidden');

  const nameAreaId = {guess:'guessNameArea', math:'mathNameArea', reaction:'reactionNameArea',
    typing:'typingNameArea', numMemory:'numNameArea', seqTap:'seqNameArea', wordChain:'wordNameArea'}[key];

  if(!document.getElementById(nameAreaId)){
    panel.innerHTML='<div id="'+nameAreaId+'"></div><div id="'+key+'PlayArea"></div><div id="'+key+'Result" class="resultline"></div><div id="'+key+'Achievements"></div><div id="'+key+'Leaderboard" class="leaderboard"></div><button onclick="returnToMenu()">Return to Menu</button>';
  }
  const nameArea = document.getElementById(nameAreaId);
  nameArea.innerHTML='';
  const inp = document.createElement('input'); inp.placeholder='Your name';
  const startBtn = document.createElement('button'); startBtn.textContent='Start';
  nameArea.appendChild(inp); nameArea.appendChild(startBtn);

  startBtn.onclick=()=>{
    const name=(inp.value||'').trim()||prompt('Enter your name','Player')||'Player';
    window.__playerName=name;
    nameArea.innerHTML='<b>Player: </b>'+escapeHTML(name)+' ';
    const fn={guess:setupGuessPanel, math:setupMathPanel, reaction:setupReactionPanel,
      typing:setupTypingPanel, numMemory:setupNumMemoryPanel, seqTap:setupSeqTapPanel,
      wordChain:setupWordChainPanel}[key];
    if(fn) fn(name);
  };
  inp.addEventListener('keydown',e=>{ if(e.key==='Enter') startBtn.click(); });
}

/* --------------------------- Guess the Number --------------------------- */
function setupGuessPanel(name){
  const playArea=document.getElementById('guessPlayArea'); playArea.innerHTML='';
  const modeSelect=document.createElement('select');
  ['Easy','Medium','Hard'].forEach(m=>{ let o=document.createElement('option'); o.text=m; modeSelect.appendChild(o); });
  playArea.appendChild(document.createTextNode('Difficulty: ')); playArea.appendChild(modeSelect);

  const startBtn=document.createElement('button'); startBtn.textContent='Start Guess';
  playArea.appendChild(startBtn);

  const result=document.getElementById('guessResult'); result.textContent='';
  const achDiv=document.getElementById('guessAchievements'); achDiv.innerHTML='';

  startBtn.onclick=()=>{
    const mode=modeSelect.value; let max=50; let attempts=10;
    if(mode==='Medium'){ max=100; attempts=8; } else if(mode==='Hard'){ max=200; attempts=5; }
    const target=Math.floor(Math.random()*max)+1; let tries=0;
    result.textContent='I have a number between 1-'+max+'. You have '+attempts+' guesses.';
    const guessInp=document.createElement('input'); guessInp.type='number';
    const guessBtn=document.createElement('button'); guessBtn.textContent='Guess';
    playArea.appendChild(document.createElement('br')); playArea.appendChild(guessInp); playArea.appendChild(guessBtn);

    guessBtn.onclick=function(){ 
      const val=parseInt(guessInp.value); if(isNaN(val)){ alert('Enter a number'); return; }
      tries++; if(val===target){ 
        result.textContent='Correct! It took '+tries+' tries.';
        saveToLB('guess',mode,{name:window.__playerName,score:tries},(a,b)=>a.score-b.score);
        showLBIn('guessLeaderboard','guess',mode,e=>e.score+' tries');
        achDiv.innerHTML='<span class="achievement">Achievement unlocked: First Win!</span>';
      } else if(tries>=attempts){ result.textContent='Game over! Number was '+target; }
      else result.textContent=(val<target?'Higher':'Lower')+'! Tries left: '+(attempts-tries);
    };
  };
}

/* --------------------------- Reaction Game --------------------------- */
function setupReactionPanel(name){
  const playArea=document.getElementById('reactionPlayArea'); playArea.innerHTML='';
  const modeSelect=document.createElement('select');
  ['Easy','Medium','Hard'].forEach(m=>{ let o=document.createElement('option'); o.text=m; modeSelect.appendChild(o); });
  playArea.appendChild(document.createTextNode('Difficulty: ')); playArea.appendChild(modeSelect);

  const startBtn=document.createElement('button'); startBtn.textContent='Start Reaction';
  playArea.appendChild(startBtn);

  const result=document.getElementById('reactionResult'); result.textContent='';
  const achDiv=document.getElementById('reactionAchievements'); achDiv.innerHTML='';

  startBtn.onclick=function(){
    const mode=modeSelect.value;
    const waitMin={Easy:1000,Medium:700,Hard:500}[mode];
    const waitMax={Easy:3000,Medium:2500,Hard:2000}[mode];
    let targetTime=0;
    const area=document.createElement('div'); area.id='reactionArea'; area.textContent='Wait for green...'; playArea.appendChild(area);
    area.style.background='#1f2226';
    const t=Math.random()*(waitMax-waitMin)+waitMin;
    setTimeout(()=>{
      area.style.background='#2ecc71'; area.textContent='Click!';
      targetTime=now();
    },t);

    area.onclick=function(){
      if(targetTime===0) return; 
      const rt=now()-targetTime;
      targetTime=0; area.textContent='Reaction: '+rt.toFixed(0)+' ms';
      saveToLB('reaction',mode,{name:window.__playerName,score:rt},(a,b)=>a.score-b.score);
      showLBIn('reactionLeaderboard','reaction',mode,e=>e.score.toFixed(0)+' ms');
      achDiv.innerHTML='<span class="achievement">Achievement unlocked: Quick Click!</span>';
    };
  };
}

/* --------------------------- Math Quiz --------------------------- */
function setupMathPanel(name){
  const playArea=document.getElementById('mathPlayArea'); playArea.innerHTML='';
  const modeSelect=document.createElement('select');
  ['Easy','Medium','Hard'].forEach(m=>{ let o=document.createElement('option'); o.text=m; modeSelect.appendChild(o); });
  playArea.appendChild(document.createTextNode('Difficulty: ')); playArea.appendChild(modeSelect);

  const startBtn=document.createElement('button'); startBtn.textContent='Start Math Quiz';
  playArea.appendChild(startBtn);

  const result=document.getElementById('mathResult'); result.textContent='';
  const achDiv=document.getElementById('mathAchievements'); achDiv.innerHTML='';

  startBtn.onclick=function(){
    const mode=modeSelect.value;
    let maxNum=10, totalQ=5;
    if(mode==='Medium'){ maxNum=20; totalQ=7; } else if(mode==='Hard'){ maxNum=50; totalQ=10; }
    let score=0, qNum=0;

    function nextQ(){
      if(qNum>=totalQ){ 
        result.textContent='Quiz done! Score: '+score+'/'+totalQ;
        saveToLB('math',mode,{name:window.__playerName,score:score},(a,b)=>b.score-a.score);
        showLBIn('mathLeaderboard','math',mode,e=>e.score+' pts');
        achDiv.innerHTML='<span class="achievement">Achievement unlocked: Math Whiz!</span>';
        return;
      }
      const a=Math.floor(Math.random()*maxNum)+1;
      const b=Math.floor(Math.random()*maxNum)+1;
      const op=['+','-','*'][Math.floor(Math.random()*3)];
      let correct=a+b; if(op==='-') correct=a-b; if(op==='*') correct=a*b;
      result.textContent='Question '+(qNum+1)+': '+a+' '+op+' '+b+' = ?';
      const ansInp=document.createElement('input'); ansInp.type='number';
      const ansBtn=document.createElement('button'); ansBtn.textContent='Answer';
      playArea.appendChild(ansInp); playArea.appendChild(ansBtn);

      ansBtn.onclick=function(){
        const val=parseInt(ansInp.value); if(val===correct) score++;
        ansInp.remove(); ansBtn.remove();
        qNum++; nextQ();
      };
    }
    nextQ();
  };
}

/* --------------------------- Typing Game --------------------------- */
function setupTypingPanel(name){
  const playArea=document.getElementById('typingPlayArea'); playArea.innerHTML='';
  const modeSelect=document.createElement('select');
  ['Easy','Medium','Hard'].forEach(m=>{ let o=document.createElement('option'); o.text=m; modeSelect.appendChild(o); });
  playArea.appendChild(document.createTextNode('Difficulty: ')); playArea.appendChild(modeSelect);

  const startBtn=document.createElement('button'); startBtn.textContent='Start Typing';
  playArea.appendChild(startBtn);

  const result=document.getElementById('typingResult'); result.textContent='';
  const achDiv=document.getElementById('typingAchievements'); achDiv.innerHTML='';

  startBtn.onclick=function(){
    const mode=modeSelect.value;
    const textLen={Easy:15,Medium:25,Hard:40}[mode];
    const chars='abcdefghijklmnopqrstuvwxyz'; let text='';
    for(let i=0;i<textLen;i++) text+=chars[Math.floor(Math.random()*chars.length)];
    result.textContent='Type this: '+text;
    const inp=document.createElement('input'); playArea.appendChild(inp);
    inp.focus();
    const doneBtn=document.createElement('button'); doneBtn.textContent='Submit'; playArea.appendChild(doneBtn);

    const startTime=now();
    doneBtn.onclick=function(){
      const timeTaken=(now()-startTime)/1000;
      const accuracy=(text.split('').filter((c,i)=>c===inp.value[i]).length/textLen*100).toFixed(0);
      result.textContent='Time: '+timeTaken.toFixed(2)+'s, Accuracy: '+accuracy+'%';
      saveToLB('typing',mode,{name:window.__playerName,score:(accuracy/100)/timeTaken},(a,b)=>b.score-a.score);
      showLBIn('typingLeaderboard','typing',mode,e=>'Score: '+(e.score*1000).toFixed(0));
      achDiv.innerHTML='<span class="achievement">Achievement unlocked: Fast Fingers!</span>';
    };
  };
}

/* --------------------------- Number Memory --------------------------- */
function setupNumMemoryPanel(name){
  const playArea=document.getElementById('numPlayArea'); playArea.innerHTML='';
  const modeSelect=document.createElement('select');
  ['Easy','Medium','Hard'].forEach(m=>{ let o=document.createElement('option'); o.text=m; modeSelect.appendChild(o); });
  playArea.appendChild(document.createTextNode('Difficulty: ')); playArea.appendChild(modeSelect);

  const startBtn=document.createElement('button'); startBtn.textContent='Start Memory';
  playArea.appendChild(startBtn);

  const result=document.getElementById('numResult'); result.textContent='';
  const achDiv=document.getElementById('numAchievements'); achDiv.innerHTML='';

  startBtn.onclick=function(){
    const mode=modeSelect.value;
    let length={Easy:3,Medium:5,Hard:7}[mode]; 
    const num=Math.floor(Math.random()*Math.pow(10,length));
    result.textContent='Remember: '+num;
    const inp=document.createElement('input'); playArea.appendChild(inp);
    const submitBtn=document.createElement('button'); submitBtn.textContent='Submit'; playArea.appendChild(submitBtn);
    setTimeout(()=>{ result.textContent='Enter the number:'; inp.focus(); },2000+length*300);
    submitBtn.onclick=function(){
      if(parseInt(inp.value)===num){ result.textContent='Correct!'; saveToLB('numMemory',mode,{name:window.__playerName,score:length},(a,b)=>b.score-a.score); showLBIn('numLeaderboard','numMemory',mode,e=>'Level '+e.score); achDiv.innerHTML='<span class="achievement">Memory Master!</span>'; }
      else result.textContent='Wrong! It was '+num;
    };
  };
}

/* --------------------------- Sequence Tap --------------------------- */
function setupSeqTapPanel(name){
  const playArea=document.getElementById('seqPlayArea'); playArea.innerHTML='';
  const modeSelect=document.createElement('select');
  ['Easy','Medium','Hard'].forEach(m=>{ let o=document.createElement('option'); o.text=m; modeSelect.appendChild(o); });
  playArea.appendChild(document.createTextNode('Difficulty: ')); playArea.appendChild(modeSelect);

  const startBtn=document.createElement('button'); startBtn.textContent='Start Sequence';
  playArea.appendChild(startBtn);

  const result=document.getElementById('seqResult'); result.textContent='';
  const achDiv=document.getElementById('seqAchievements'); achDiv.innerHTML='';

  startBtn.onclick=function(){
    const mode=modeSelect.value;
    let colors=['red','green','blue','yellow']; if(mode==='Medium') colors.push('orange'); if(mode==='Hard') colors.push('purple');
    let seq=[], level=0;
    const displaySeq=document.createElement('div'); playArea.appendChild(displaySeq);
    const buttons=colors.map(c=>{ let b=document.createElement('div'); b.className='color-btn'; b.style.background=c; displaySeq.appendChild(b); return b; });
    
    function nextLevel(){
      const newColor=colors[Math.floor(Math.random()*colors.length)]; seq.push(newColor); level++;
      let idx=0; result.textContent='Level '+level;
      function flash(){ if(idx>=seq.length) return; buttons.find(b=>b.style.background===seq[idx]).style.border='3px solid #fff'; setTimeout(()=>{ buttons.find(b=>b.style.background===seq[idx]).style.border='3px solid rgba(255,255,255,0.06)'; idx++; setTimeout(flash,300); },300); }
      flash();
      let userIdx=0;
      buttons.forEach(b=>b.onclick=function(){ if(seq[userIdx]===b.style.background){ userIdx++; if(userIdx>=seq.length){ saveToLB('seqTap',mode,{name:window.__playerName,score:level},(a,b)=>b.score-a.score); showLBIn('seqLeaderboard','seqTap',mode,e=>'Level '+e.score); achDiv.innerHTML='<span class="achievement">Sequence Pro!</span>'; nextLevel(); } } else { result.textContent='Game Over! Reached level '+level; } });
    }
    nextLevel();
  };
}

/* --------------------------- Word Memory Chain --------------------------- */
function setupWordChainPanel(name){
  const playArea=document.getElementById('wordPlayArea'); playArea.innerHTML='';
  const modeSelect=document.createElement('select');
  ['Easy','Medium','Hard'].forEach(m=>{ let o=document.createElement('option'); o.text=m; modeSelect.appendChild(o); });
  playArea.appendChild(document.createTextNode('Difficulty: ')); playArea.appendChild(modeSelect);

  const startBtn=document.createElement('button'); startBtn.textContent='Start Word Chain';
  playArea.appendChild(startBtn);

  const result=document.getElementById('wordResult'); result.textContent='';
  const achDiv=document.getElementById('wordAchievements'); achDiv.innerHTML='';

  startBtn.onclick=function(){
    const mode=modeSelect.value;
    let length={Easy:3,Medium:5,Hard:7}[mode];
    let chain=[], words=['apple','orange','banana','grape','melon','kiwi','peach','pear','plum','mango'];
    let level=0;

    function nextRound(){
      const word=words[Math.floor(Math.random()*words.length)]; chain.push(word); level++;
      result.textContent='Remember: '+chain.join(' ');
      setTimeout(()=>{ 
        const inp=document.createElement('input'); playArea.appendChild(inp); inp.focus();
        const submitBtn=document.createElement('button'); submitBtn.textContent='Submit'; playArea.appendChild(submitBtn);
        submitBtn.onclick=function(){
          if(inp.value.trim()===chain.join(' ')){ result.textContent='Correct!'; saveToLB('wordChain',mode,{name:window.__playerName,score:level},(a,b)=>b.score-a.score); showLBIn('wordLeaderboard','wordChain',mode,e=>'Level '+e.score); achDiv.innerHTML='<span class="achievement">Word Wizard!</span>'; inp.remove(); submitBtn.remove(); nextRound(); }
          else result.textContent='Wrong! Chain ended at level '+level;
        };
      },1000+level*300);
    }
    nextRound();
  };
}
</script>
</body>
</html>
